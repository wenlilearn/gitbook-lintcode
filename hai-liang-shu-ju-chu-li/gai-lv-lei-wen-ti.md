# 概率类问题

### 什么是概率类问题

* 概率类问题是诸如在n个元素中等概率取k个元素这样的题目
* 概率公式: 如果一个概率是n/m的话, 那么可以用random\(1, m\) &lt;= n来模拟

### 概率类问题

1. 如果一个文件很大, 并不能全部放入内存, 如何等概率选出其中一行?
   * 先把第一行作为返回值
   * 如果之后还有更多的行\(hasNext\(\)\)
     * 每次先读一行
     * 然后把行数 + 1\(这样才能保证这一行选出来的概率是1/k\(k是已经选出的行数\)\)
     * 对\(0, 新行数\)进行random
       * 如果小于1, 那么就选择当前行\(实际上就是等于0, 也就是1/k中的那个1\)
2. 给定一个query, 随机挑选出n条results
   * 离线的做法是直接调出所有的query, 假设长度为m, 那么我们对于每一条我们就用n/m的概率挑选即可
   * 在线的算法:
     * 我们开一个n的buffer
     * 如果buffer没满而且result满足条件, 那么我们就把result放入buffer
     * 如果buffer满了
       * 假设我们一共见过m条满足条件的result
       * 那么我们用n/m的概率挑选当前这一条\(random\(1, m\) &lt;= n\)
         * 如果没选中, 就可以放弃
         * 如果选中了, 那么从所有的results按照1/m的概率随机丢弃一条\(random\(1, m\) &lt;= 1\)里面随机丢弃一条 



